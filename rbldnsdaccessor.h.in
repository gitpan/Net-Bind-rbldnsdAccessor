/*	rbldnsdaccessor.h.in	version 1.01

NOTE:	DON'T EDIT rbldnsdaccessor.h, it is generated by Makefile.PL

EDIT:	rbldnsdaccessor.in


 Copyright 2006, Michael Robinton, michael@bizsystems.com
 
 This program is free software; you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation; either version 2 of the License, or 
 (at your option) any later version.
 
 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of 
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  
 GNU General Public License for more details.
 
 You should have received a copy of the GNU General Public License
 along with this program; if not, write to the Free Software
 Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 */


#ifndef RBLDNSDACCESSOR_H
#define RBLDNSDACCESSOR_H 1

void rblf_drop(void);
void oom(void);

# ifdef RBLFBASE_H

typedef unsigned int
(*rblf_dns_sdb_putrdata_t)(void *,u_int16_t,u_int32_t,const unsigned char *,unsigned int);

# else

# include <config.h>

# include <stdio.h>
# include <string.h>
# include <stdlib.h>

# include <isc/print.h>
# include <isc/result.h>
# include <isc/util.h>

# include <dns/log.h>
# include <dns/sdb.h>
# include <dns/result.h>

# include <named/globals.h>

typedef isc_result_t (*rblf_dns_sdb_putrdata_t)(dns_sdblookup_t *lookup, dns_rdatatype_t type, dns_ttl_t ttl, const unsigned char *rdata, unsigned int rdlen);

isc_result_t rblf_lookup(const char * zone, const char *name, void * dbdata, dns_sdblookup_t * lookup);
isc_result_t rblf_isc_lookup(const char * name,dns_sdblookup_t * lookup, rblf_dns_sdb_putrdata_t put_rr_callback);
int do_reload(int always_zero);
isc_result_t rblf_create_zone(const char *zone, int argc, char **argv, void *driverdata, void **dbdata);

isc_result_t rbldnsd_init(void);
void rbldnsd_clear(void);

# endif

#endif
